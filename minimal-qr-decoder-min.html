<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Minimal QR File Decoder</title><style>* { margin: 0; padding: 0; box-sizing: border-box; }
body {
font-family: -apple-system, BlinkMacSystemFont, sans-serif;
padding: 20px;
max-width: 800px;
margin: 0 auto;
background: #f9fafb;
}
.container {
background: white;
padding: 20px;
border-radius: 8px;
box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}
h1 { color: #2563eb; margin-bottom: 20px; }
.input-area {
margin-bottom: 20px;
padding: 15px;
border: 2px dashed #d1d5db;
border-radius: 8px;
background: #f9fafb;
}
textarea {
width: 100%;
height: 120px;
padding: 10px;
border: 1px solid #d1d5db;
border-radius: 4px;
font-family: monospace;
font-size: 12px;
}
button {
background: #2563eb;
color: white;
border: none;
padding: 10px 20px;
border-radius: 4px;
cursor: pointer;
margin: 5px;
}
button:hover { background: #1d4ed8; }
button:disabled { background: #9ca3af; cursor: not-allowed; }
.status {
margin: 10px 0;
padding: 10px;
border-radius: 4px;
background: #f0f9ff;
border-left: 4px solid #2563eb;
}
.error { background: #fef2f2; border-left-color: #ef4444; color: #b91c1c; }
.success { background: #f0fdf4; border-left-color: #10b981; color: #059669; }
.progress {
width: 100%;
height: 10px;
background: #e5e7eb;
border-radius: 5px;
overflow: hidden;
margin: 10px 0;
}
.progress-bar {
height: 100%;
background: #2563eb;
width: 0%;
transition: width 0.3s;
}
.file-info {
margin: 15px 0;
padding: 15px;
background: #f8fafc;
border-radius: 6px;
border: 1px solid #e2e8f0;
}
.chunk-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(20px, 1fr));
gap: 2px;
margin: 10px 0;
}
.chunk {
height: 20px;
background: #e5e7eb;
border-radius: 2px;
border: 1px solid #d1d5db;
}
.chunk.received { background: #dcfce7; border-color: #10b981; }
.instructions {
background: #fffbeb;
border: 1px solid #fbbf24;
border-radius: 6px;
padding: 15px;
margin-bottom: 20px;
}
.instructions h3 { color: #d97706; margin-bottom: 10px; }
.instructions ol { margin-left: 20px; }
.instructions li { margin: 5px 0; }</style></head><body><div class="container"><h1>üì± Minimal QR File Decoder</h1><div class="instructions"><h3>üöÄ How to Use (Works with ANY QR Scanner App):</h3><ol><li><strong>Use your phone's camera or any QR scanner app</strong></li><li><strong>Scan each QR code</strong> from the video/display</li><li><strong>Copy and paste</strong> each scanned text into the box below</li><li><strong>Click "Add QR Data"</strong> after each scan</li><li><strong>File will rebuild automatically</strong> as you scan more codes</li><li><strong>Download</strong> when complete!</li></ol></div><div class="input-area"><h3>üìã Paste QR Code Data Here:</h3><textarea id="qrInput" placeholder="Paste the QR code text here (from your QR scanner app) and click 'Add QR Data'..."></textarea><button onclick="addQRData()" id="addBtn">Add QR Data</button><button onclick="clearInput()" id="clearBtn">Clear Input</button><button onclick="clearAll()" id="resetBtn">Reset All</button></div><div id="status" class="status">
Ready to scan QR codes. Use any QR scanner app on your phone!
</div><div class="progress"><div class="progress-bar" id="progressBar"></div></div><div id="fileInfo" class="file-info" style="display: none;"><h3>üìÑ File Information</h3><div id="fileName">Unknown</div><div id="fileSize">Unknown size</div><div id="chunksInfo">Chunks: 0/0</div><div class="chunk-grid" id="chunkGrid"></div></div><div id="downloadArea" style="display: none; margin-top: 20px;"><button onclick="downloadFile()" style="background: #10b981; font-size: 16px; padding: 15px 30px;">
üì• Download Recovered File
</button></div><div id="log" style="margin-top: 20px; font-family: monospace; font-size: 12px; background: #f1f5f9; padding: 10px; border-radius: 4px; max-height: 200px; overflow-y: auto;"></div></div><script>let discoveredFiles = new Map();
let currentFile = null;
let processedQRs = new Set();
let scannedCount = 0;
function addQRData() {
const input = document.getElementById('qrInput');
const qrData = input.value.trim();
if (!qrData) {
showStatus('‚ö†Ô∏è Please paste QR code data first', 'error');
return;
}
if (processedQRs.has(qrData)) {
showStatus('‚ö†Ô∏è This QR code was already processed', 'error');
return;
}
try {
processQRCode(qrData);
processedQRs.add(qrData);
scannedCount++;
input.value = '';
input.focus();
log(`‚úÖ Processed QR #${scannedCount}: ${qrData.substring(0, 50)}...`);
} catch (error) {
showStatus(`‚ùå Error processing QR: ${error.message}`, 'error');
log(`‚ùå Error: ${error.message}`);
}
}
function processQRCode(qrData) {
if (qrData.startsWith('M:')) {
processMetadata(qrData);
} else if (qrData.startsWith('D:')) {
processDataPacket(qrData);
} else {
throw new Error('Unknown QR code format');
}
}
function processMetadata(metaData) {
const parts = metaData.split(':');
if (parts.length < 6) {
throw new Error('Invalid metadata format');
}
const fileName = decodeURIComponent(parts[2]);
const fileSize = parseInt(parts[4]);
const totalChunks = parseInt(parts[5]);
log(`üìÅ Found file: ${fileName} (${formatFileSize(fileSize)}, ${totalChunks} chunks)`);
if (!discoveredFiles.has(fileName)) {
discoveredFiles.set(fileName, {
fileName: fileName,
fileSize: fileSize,
totalChunks: totalChunks,
chunks: new Map(),
recoveredChunks: 0
});
showFileInfo(fileName, fileSize, totalChunks);
showStatus(`üìÅ Discovered file: ${fileName}`, 'success');
}
currentFile = fileName;
}
function processDataPacket(dataString) {
if (!currentFile) {
throw new Error('No file metadata found yet. Scan metadata QR first!');
}
const parts = dataString.split(':');
if (parts.length < 7) {
throw new Error('Invalid data packet format');
}
const fileInfo = discoveredFiles.get(currentFile);
const chunkCount = parseInt(parts[5]);
const dataSection = parts.slice(6).join(':');
const chunkRecords = dataSection.split('|');
let newChunks = 0;
for (const record of chunkRecords) {
const recordParts = record.split(':', 2);
if (recordParts.length === 2) {
const chunkIndex = parseInt(recordParts[0]);
const chunkData = recordParts[1];
if (!fileInfo.chunks.has(chunkIndex)) {
fileInfo.chunks.set(chunkIndex, chunkData);
fileInfo.recoveredChunks++;
newChunks++;
updateChunkGrid(chunkIndex);
}
}
}
if (newChunks > 0) {
log(`üì¶ Added ${newChunks} new chunks. Total: ${fileInfo.recoveredChunks}/${fileInfo.totalChunks}`);
updateProgress();
if (fileInfo.recoveredChunks >= fileInfo.totalChunks) {
completeFile();
}
} else {
log(`üîÑ No new chunks in this QR (already had these chunks)`);
}
}
function completeFile() {
const fileInfo = discoveredFiles.get(currentFile);
try {
let reconstructedData = '';
for (let i = 0; i < fileInfo.totalChunks; i++) {
if (fileInfo.chunks.has(i)) {
reconstructedData += fileInfo.chunks.get(i);
} else {
throw new Error(`Missing chunk ${i}`);
}
}
const binaryString = atob(reconstructedData);
const bytes = new Uint8Array(binaryString.length);
for (let i = 0; i < binaryString.length; i++) {
bytes[i] = binaryString.charCodeAt(i);
}
fileInfo.completedData = bytes;
showStatus(`‚úÖ File ${currentFile} completed! Ready for download.`, 'success');
log(`‚úÖ File reconstruction complete: ${currentFile} (${bytes.length} bytes)`);
document.getElementById('downloadArea').style.display = 'block';
} catch (error) {
showStatus(`‚ùå File reconstruction failed: ${error.message}`, 'error');
log(`‚ùå Reconstruction error: ${error.message}`);
}
}
function downloadFile() {
const fileInfo = discoveredFiles.get(currentFile);
if (!fileInfo || !fileInfo.completedData) {
showStatus('‚ùå No completed file to download', 'error');
return;
}
try {
const blob = new Blob([fileInfo.completedData], { type: 'application/octet-stream' });
const url = URL.createObjectURL(blob);
const a = document.createElement('a');
a.href = url;
a.download = fileInfo.fileName;
document.body.appendChild(a);
a.click();
document.body.removeChild(a);
URL.revokeObjectURL(url);
showStatus(`üì• Downloaded: ${fileInfo.fileName}`, 'success');
log(`üì• Downloaded: ${fileInfo.fileName}`);
} catch (error) {
showStatus(`‚ùå Download failed: ${error.message}`, 'error');
}
}
function showStatus(message, type = '') {
const status = document.getElementById('status');
status.textContent = message;
status.className = `status ${type}`;
}
function showFileInfo(fileName, fileSize, totalChunks) {
document.getElementById('fileName').textContent = `üìÑ ${fileName}`;
document.getElementById('fileSize').textContent = `üìä Size: ${formatFileSize(fileSize)}`;
document.getElementById('chunksInfo').textContent = `üß© Chunks: 0/${totalChunks}`;
const grid = document.getElementById('chunkGrid');
grid.innerHTML = '';
for (let i = 0; i < totalChunks; i++) {
const chunk = document.createElement('div');
chunk.className = 'chunk';
chunk.id = `chunk-${i}`;
grid.appendChild(chunk);
}
document.getElementById('fileInfo').style.display = 'block';
}
function updateChunkGrid(chunkIndex) {
const chunk = document.getElementById(`chunk-${chunkIndex}`);
if (chunk) {
chunk.classList.add('received');
}
}
function updateProgress() {
const fileInfo = discoveredFiles.get(currentFile);
if (!fileInfo) return;
const progress = (fileInfo.recoveredChunks / fileInfo.totalChunks) * 100;
document.getElementById('progressBar').style.width = `${progress}%`;
document.getElementById('chunksInfo').textContent = `üß© Chunks: ${fileInfo.recoveredChunks}/${fileInfo.totalChunks} (${Math.round(progress)}%)`;
}
function log(message) {
const logDiv = document.getElementById('log');
const timestamp = new Date().toLocaleTimeString();
logDiv.innerHTML += `[${timestamp}] ${message}<br>`;
logDiv.scrollTop = logDiv.scrollHeight;
}
function formatFileSize(bytes) {
if (bytes < 1024) return `${bytes} bytes`;
if (bytes < 1024 * 1024) return `${(bytes / 1024).toFixed(1)} KB`;
return `${(bytes / (1024 * 1024)).toFixed(2)} MB`;
}
function clearInput() {
document.getElementById('qrInput').value = '';
document.getElementById('qrInput').focus();
}
function clearAll() {
discoveredFiles.clear();
processedQRs.clear();
currentFile = null;
scannedCount = 0;
document.getElementById('qrInput').value = '';
document.getElementById('fileInfo').style.display = 'none';
document.getElementById('downloadArea').style.display = 'none';
document.getElementById('progressBar').style.width = '0%';
document.getElementById('log').innerHTML = '';
showStatus('Reset complete. Ready to scan QR codes.', '');
}
document.addEventListener('keydown', (e) => {
if (e.ctrlKey && e.key === 'Enter') {
addQRData();
}
});
log('üì± Minimal QR decoder ready. Use any QR scanner app!');
log('üí° Tip: Press Ctrl+Enter to quickly add QR data');
document.getElementById('qrInput').focus();</script></body></html>