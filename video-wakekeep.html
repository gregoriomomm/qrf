<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Presentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: Arial, sans-serif;
        }

        .video-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            background: #111;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }

        video {
            width: 100%;
            height: auto;
            display: block;
        }

        .info {
            position: absolute;
            bottom: 10px;
            left: 10px;
            color: rgba(255,255,255,0.7);
            font-size: 12px;
            background: rgba(0,0,0,0.5);
            padding: 5px 10px;
            border-radius: 4px;
        }

        .controls {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            border-radius: 4px;
            padding: 5px;
        }

        .status {
            color: #00ff00;
            font-size: 10px;
        }
    </style>
</head>
<body>
    <div class="video-container">
        <video
            id="mainVideo"
            autoplay
            loop
            muted
            playsinline
            preload="auto"
            style="width: 100%; height: auto; display: block;">
            <!-- Big Buck Bunny - reliable test video -->
            <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
            <!-- Alternative: Sintel short film -->
            <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4" type="video/mp4">
            <!-- Fallback: very small test video -->
            <source src="https://sample-videos.com/zip/10/mp4/SampleVideo_128x96_1mb_mp4.mp4" type="video/mp4">
            <!-- Local fallback canvas -->
            <canvas id="fallbackCanvas" width="800" height="450" style="width: 100%; height: auto; background: #111;"></canvas>
        </video>

        <div class="info">
            Reprodução contínua ativa
        </div>

        <div class="controls">
            <div class="status" id="status">● ATIVO</div>
        </div>
    </div>

    <script>
        // Prevent screen lock by simulating user activity
        let wakeLock = null;
        let activityTimer = null;

        // Wake Lock API (modern browsers)
        async function requestWakeLock() {
            try {
                if ('wakeLock' in navigator) {
                    wakeLock = await navigator.wakeLock.request('screen');
                    console.log('Wake lock ativado');
                    updateStatus('WAKE LOCK ATIVO');
                }
            } catch (err) {
                console.log('Wake lock não suportado:', err);
                fallbackPreventSleep();
            }
        }

        // Fallback: simulate user activity
        function fallbackPreventSleep() {
            // Move invisible element to simulate activity
            const phantom = document.createElement('div');
            phantom.style.position = 'absolute';
            phantom.style.left = '-9999px';
            phantom.style.width = '1px';
            phantom.style.height = '1px';
            document.body.appendChild(phantom);

            activityTimer = setInterval(() => {
                // Simulate minimal mouse movement
                phantom.style.left = phantom.style.left === '-9999px' ? '-9998px' : '-9999px';

                // Dispatch a minimal mouse event
                const event = new MouseEvent('mousemove', {
                    bubbles: false,
                    cancelable: false,
                    clientX: 1,
                    clientY: 1
                });
                document.dispatchEvent(event);
            }, 30000); // Every 30 seconds

            updateStatus('SIMULAÇÃO ATIVA');
        }

        function updateStatus(text) {
            const status = document.getElementById('status');
            if (status) {
                status.textContent = '● ' + text;
            }
        }

        // Fallback canvas animation for when video fails
        function startFallbackCanvas() {
            const canvas = document.getElementById('fallbackCanvas');
            if (!canvas) return;

            const ctx = canvas.getContext('2d');
            let frame = 0;

            function animate() {
                const time = frame * 0.02;

                // Clear with dark background
                ctx.fillStyle = '#0a0a0a';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                // Simple moving elements
                ctx.fillStyle = 'rgba(100, 200, 255, 0.3)';
                ctx.fillRect(
                    (canvas.width / 2) + Math.sin(time) * 100 - 25,
                    (canvas.height / 2) - 25,
                    50, 50
                );

                ctx.fillStyle = 'rgba(255, 255, 255, 0.6)';
                ctx.font = '16px Arial';
                ctx.fillText('Vídeo ativo', 20, canvas.height - 20);

                frame++;
                requestAnimationFrame(animate);
            }
            animate();
        }

        // Generate minimal MP4 data URL
        function createMinimalVideo() {
            return 'data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAAADVtZGF0AAAJHggO0ODAAAA=';
        }

        // Initialize video and wake lock
        document.addEventListener('DOMContentLoaded', () => {
            const video = document.getElementById('mainVideo');

            // Video event handlers
            video.addEventListener('loadstart', () => {
                updateStatus('CARREGANDO VÍDEO');
            });

            video.addEventListener('canplay', () => {
                updateStatus('VÍDEO PRONTO');
                video.play().then(() => {
                    requestWakeLock();
                    updateStatus('REPRODUZINDO');
                }).catch(e => {
                    console.log('Autoplay falhou:', e);
                    updateStatus('CLIQUE PARA ATIVAR');
                });
            });

            video.addEventListener('error', () => {
                console.log('Erro no vídeo, usando fallback');
                updateStatus('MODO FALLBACK');
                startFallbackCanvas();
                requestWakeLock();
            });

            // Click to start if autoplay is blocked
            document.addEventListener('click', () => {
                if (video.paused) {
                    video.play().then(() => {
                        requestWakeLock();
                        updateStatus('REPRODUZINDO');
                    });
                }
            }, { once: true });

            // If no video loads, create minimal one
            setTimeout(() => {
                if (video.networkState === video.NETWORK_NO_SOURCE) {
                    const source = document.createElement('source');
                    source.src = createMinimalVideo();
                    source.type = 'video/mp4';
                    video.appendChild(source);
                    video.load();
                }
            }, 3000);

            // Handle page visibility changes
            document.addEventListener('visibilitychange', () => {
                if (document.hidden && wakeLock) {
                    wakeLock.release();
                    wakeLock = null;
                } else if (!document.hidden && !wakeLock) {
                    requestWakeLock();
                }
            });
        });

    </script>
</body>
</html>