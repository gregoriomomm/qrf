<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Ultra Minimal QR Decoder</title><style>body{font-family:Arial,sans-serif;padding:10px;max-width:600px;margin:0 auto}
.box{border:1px solid #ccc;padding:10px;margin:10px 0;border-radius:4px}
textarea{width:100%;height:80px;margin:5px 0}
button{background:#007bff;color:white;border:none;padding:8px 16px;margin:2px;border-radius:3px;cursor:pointer}
button:hover{background:#0056b3}
.success{background:#d4edda;color:#155724}
.error{background:#f8d7da;color:#721c24}
.progress{width:100%;height:8px;background:#eee;margin:5px 0}
.bar{height:100%;background:#007bff;width:0%;transition:width 0.3s}</style></head><body><h2>ğŸ“± Ultra Minimal QR Decoder</h2><div class="box"><b>ğŸ“‹ Scan QR â†’ Paste Here â†’ Click Add:</b><br><textarea id="qr" placeholder="Paste QR text here..."></textarea><button onclick="add()">Add QR</button><button onclick="clear()">Clear</button><button onclick="reset()">Reset</button></div><div id="msg" class="box">Ready! Use phone camera/QR app â†’ scan â†’ paste â†’ add</div><div class="progress"><div id="bar" class="bar"></div></div><div id="info" class="box" style="display:none"></div><div id="down" style="display:none"><button onclick="download()" style="background:#28a745;font-size:18px;padding:12px 24px">ğŸ“¥ Download File</button></div><script>let files={},curr='',chunks={},total=0,got=0;
function add(){
const d=document.getElementById('qr').value.trim();
if(!d){msg('âš ï¸ Paste QR data first','error');return}
try{
if(d.startsWith('M:')){
const p=d.split(':');
curr=decodeURIComponent(p[2]);
total=parseInt(p[5]);
chunks={};got=0;
files[curr]={name:curr,size:parseInt(p[4]),total:total,chunks:{}};
document.getElementById('info').innerHTML=`<b>ğŸ“„ ${curr}</b><br>Size: ${fmt(files[curr].size)}<br>Chunks: 0/${total}`;
document.getElementById('info').style.display='block';
msg(`ğŸ“ File: ${curr}`,'success');
}else if(d.startsWith('D:')&&curr){
const p=d.split(':');
const data=p.slice(6).join(':').split('|');
let newChunks=0;
for(const r of data){
const cp=r.split(':',2);
if(cp.length===2){
const idx=parseInt(cp[0]);
if(!chunks[idx]){chunks[idx]=cp[1];got++;newChunks++}
}
}
if(newChunks>0){
document.getElementById('info').innerHTML=`<b>ğŸ“„ ${curr}</b><br>Size: ${fmt(files[curr].size)}<br>Chunks: ${got}/${total} (${Math.round(got/total*100)}%)`;
document.getElementById('bar').style.width=`${got/total*100}%`;
msg(`ğŸ“¦ +${newChunks} chunks (${got}/${total})`,'success');
if(got>=total){complete()}
}else{msg('ğŸ”„ No new chunks','');}
}else{throw new Error('Scan metadata QR first!')}
document.getElementById('qr').value='';
}catch(e){msg(`âŒ ${e.message}`,'error')}
}
function complete(){
try{
let data='';
for(let i=0;i<total;i++){
if(!chunks[i])throw new Error(`Missing chunk ${i}`);
data+=chunks[i];
}
const bin=atob(data);
const bytes=new Uint8Array(bin.length);
for(let i=0;i<bin.length;i++)bytes[i]=bin.charCodeAt(i);
files[curr].data=bytes;
msg(`âœ… ${curr} complete!`,'success');
document.getElementById('down').style.display='block';
}catch(e){msg(`âŒ Reconstruction failed: ${e.message}`,'error')}
}
function download(){
if(!files[curr]||!files[curr].data){msg('âŒ No file ready','error');return}
const blob=new Blob([files[curr].data]);
const url=URL.createObjectURL(blob);
const a=document.createElement('a');
a.href=url;a.download=files[curr].name;
document.body.appendChild(a);a.click();document.body.removeChild(a);
URL.revokeObjectURL(url);
msg(`ğŸ“¥ Downloaded: ${files[curr].name}`,'success');
}
function msg(text,type){
const el=document.getElementById('msg');
el.textContent=text;el.className=`box ${type}`;
}
function clear(){document.getElementById('qr').value='';document.getElementById('qr').focus()}
function reset(){
files={};curr='';chunks={};total=0;got=0;
document.getElementById('qr').value='';
document.getElementById('info').style.display='none';
document.getElementById('down').style.display='none';
document.getElementById('bar').style.width='0%';
msg('Reset complete. Ready to scan!','');
}
function fmt(b){
if(b<1024)return b+' B';
if(b<1048576)return Math.round(b/1024)+' KB';
return(b/1048576).toFixed(1)+' MB';
}
document.getElementById('qr').focus();
document.getElementById('qr').addEventListener('keypress',e=>{if(e.key==='Enter')add()});</script></body></html>